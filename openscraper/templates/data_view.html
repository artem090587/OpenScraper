{% extends "main.html" %}
{% autoescape None %}

{% block body %}


<br>

<section class="section">
	
	<div class="container has-text-centered">
		
		{# <h1 class="title">
			Data set overview
			<div class="has-text-weight-light"> {% module MainTabs() %}</div>
		</h1>
		
		<h2 class="subtitle">
			this is the data you have scraped so far (add search engine here)
		</h2> #}

		<div class="dropdown is-hoverable">
			
			<div class="dropdown-trigger"> 
				
				<button class="button is-large is-rounded" aria-haspopup="true" aria-controls="dropdown-menu-data">
					<span>
						<b>Data set overview</b>  
					</span>
				</button>
				
				<button class="button  is-text" aria-haspopup="true" aria-controls="dropdown-menu-data">
					<span class="icon">
						<i class="fas fa-question-circle"></i>
					</span>
				</button>
				
				{# tabs #}
				<div class="has-text-weight-light"> {% module MainTabs(site_section) %}</div>
			
			</div>

			<div class="dropdown-menu" id="dropdown-menu-data" role="menu">
			<div class="dropdown-content">
				<div class="dropdown-item">
					<p>
						this is the <b>data you have scraped</b> so far (add search engine here)
					</p>
				</div>
			</div>
			</div>

		</div>


	</div>


	<hr>

	{# data table container #}

	<div class="container" >

		{% if is_data %}

		<div class="columns is-centered">
			<div class="column is-half">
				{% module Pagination( pagination_dict ) %}
			</div>
		</div>

		<div class="columns is-centered">
			
			<div class="column"   style="overflow-x: scroll;">

				{# data #}
				<table 	id="t_dataset " 
						class="table display is-striped is-narrow is-hoverable is-fullwidth" 
						width="100%" 
						cellspacing="0"
						>
					<thead>
						<tr>
							
							<th>spider used</th>
							<th>link_src</th>
							
							{% for field in datamodel_custom %}
								<th>{{ field["field_name"] }}</th>
							{% end %}

						</tr>
					</thead>

					{# displaying data if there is ... #}
					<tbody>

						{% for item in items %}

							<tr >

								<td> 
									<a href="/contributors" >
										{{ escape (item["spider_name"]) }} 
									</a>
								</td>


								<th>
									<a href="{{ escape ( item['link_src'] ) }}" target="_blank">
										<span class="tag is-white">
											<span class="icon is-small"><i class="fas fa-external-link-alt"></i></span> 
										</span>
									</a>
								</th>


								{% for field in datamodel_custom %}
									
									{% set id_field 	= str(field[u"_id"]) %}
									{% set type_field 	= str(field[u"field_type"]) %}

									{% if id_field in item.keys() %}
										
										<td>
											{% for i in item[ id_field ]  %} 
												
												{% if type_field == u"tags" %}
													<span class="tag is-dark"> {{ escape (i) }} </span>
												{% else %}
													{{ escape (i) }} 
												{% end %}
												
											{% end %}
										</td>

									{% else %}
										<td> - </td>

									{% end %}

								{% end %}

							</tr>

						{% end %}


					</tbody>


				</table>

			</div>
		
		</div>

		{% else %}
			
		<br><hr>
		<div class="container has-text-centered">
			<p class="is-centered"> no results </p>
		</div>
		<br>
			
		{% end %}

	</div>


	
</section>

{% end %}
